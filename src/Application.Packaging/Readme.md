# nventive.Nimue.ApplicationPackaging
A set of MSBuild targets providing features related to cross-platform application packaging:
- Support for [`PackageOutputPath`](https://docs.microsoft.com/en-us/dotnet/core/tools/csproj#packageoutputpath) in Xamarin.Android, Xamarin.iOS and UAP applications.
- Dynamic change of the application identifier in Xamarin.Android

## Why would I use it?
When installed, this package provides a single way of setting the output path for the packages generated by a Xamarin.iOS, Xamarin.Android, UAP or WebAssembly application project.
To make it even easier, the variable used for this purpose is [the one used when creating NuGet packages](https://docs.microsoft.com/en-us/dotnet/core/tools/csproj#packageoutputpath).

Another feature available in this package is the ability to change the application identifier of a Xamarin.Android application at build time. This allows to adjust the package id according to build parameters like configuration or platform.

## How to use it?
Simply install the NuGet package in the your UAP, Xamarin.Android and Xamarin.iOS application projects. 

### PackageOutputPath

*Note: This feature is disaled when building in Visual Studio*

#### Project level
In the csproj file, add the following:
```xml
<PropertyGroup>
    <PackageOutputPath>$(SolutionDir)\Packages\</PackageOutputPath>
</PropertyGroup>
```
This will cause all the packages to be placed in a `Packages` folder in the folder where the solution is located.

*Note: The path can be set to any value*

#### Command line
When building the solution with the MSBuild command line, use the following:
```cmd
msbuild.exe [...] /p:PackageOutputPath=C:\Packages\
```

#### Azure Pipelines YAML
When building the solution with Azure Pipelines, `PackageOutputPath` is automatically set to `$(Build.ArtifactStagingDirectory)`, which is the standard location to place build artifacts. The path can also be set like so
```yml
variables:
- name: PackageOutputPath
  value: C:\Packages\
```

### Application Identifier

#### Project level
In the csproj file, add the following:
```xml
<PropertyGroup>
    <ApplicationIdentifier>com.company.debug</PackageOutputPath>
    <ApplicationIdentifier Condition="'$(Configuration)' == 'Release'">com.company.release</PackageOutputPath>
</PropertyGroup>
```
This will cause the identifier to be changed to `com.company.release` in Release and `com.company.debug` in Debug.
Beware when using the `ApplicationIdentifier` this way as it will cause `.cs` and `.xml` files to be re-written every time the application is built.

*Note: the condition can be changed to anything*

#### Azure Pipelines YAML
When building the solution with Azure Pipelines, when specifying the build configuration (either at the variables level or in the MSBuild step itself), add the following variable
```yml
variables:
- name: ApplicationIdentifier
  value: com.company.release
```
